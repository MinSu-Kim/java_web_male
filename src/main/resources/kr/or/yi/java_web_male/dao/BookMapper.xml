<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.or.yi.java_web_male.dao.BookMapper">

	<sql id="selectSql">
		select * from book
	</sql>
	
	<sql id="whereSql">
		<where>
			<if test="bookCode != null">
				book_code=#{bookCode}
			</if>
		</where>
	</sql>
	
	<select id="selectBookByAll" parameterType="Book"
		resultType="Book">
		<include refid="selectSql" />
	</select>
	
	<!-- updateSql -->
	<sql id="updateSql">
		update book set book_no=#{bookNo}, author=#{writter}, translator=#{translator}, title=#{title}, price=#{priece}, rental_possible=#{rentable}, image=#{image}, cate_s_no=#{categorynoS.categorynoS}, cate_m_no=#{categorynoM.categorynoM}, cate_b_no=#{categorynoB.categorynoB}, pub_no=#{publisherNo.publisherNo}
		WHERE book_code=#{bookCode};
	</sql>
	
	<select id="selectbookbybookCode" parameterType="Book"
		resultType="Book">
		<include refid="selectSql" />
		<include refid="whereSql" />
	</select>
	
	<!-- <resultMap type="Book" id="Booktyepinsert">
		<id property="studId" column="stud_id"/>
		<result property="bookCode" column="book_code"/>
		<result property="bookNo" column="book_no"/>
		<result property="Publisher.name" column="publisher_no"/>
		<result property="writter" column="writter"/>
		<result property="translator" column="translator"/>
		<result property="title" column="title"/>
		<result property="priece" column="priece"/>
		<result property="rentable" column="rentable"/>
		<result property="categorynoB.categorynoB" column="categoryno_B"/>
		<result property="categorynoM.categorynoM" column="categoryno_M"/>
		<result property="categorynoS.categorynoS" column="categoryno_S"/>		
	</resultMap> -->
	
	<insert id="insertBook" parameterType="Book">
		INSERT INTO proj_library.book (book_code, book_no, publisher_no, writter, translator, title, priece, rentable,image, categoryno_s, categoryno_m, categoryno_b)
		VALUES (#{bookCode},#{bookNo},#{publisherNo.publisherNo}, #{writter}, #{translator}, #{title}, #{priece}, #{rentable}, #{image}, #{categorynoS.categorynoS}, #{categorynoM.categorynoM}, #{categorynoB.categorynoB})
	</insert>
	
	<update id="updateBook" parameterType="Book">
		<include refid="updateSql" />
	</update>

</mapper>